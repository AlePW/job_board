% developer = this.current_developer
% favorites = developer.favorites

{{ this.partial("search_box") }}

<span>
  <h1>My favorites ({{ favorites.size }})</h1>

  % if favorites.empty?
    <p>You have no favorite posts yet.</p>
  % else
    <ul>
      % favorites.each do |post|
        % if !post.expired?
          <li>
            <article>
              <header>
                <h1>{{ post.company.name.encode(xml: :text) }}</h1>
                <a href="{{ post.company.url}}">{{ post.company.url.encode(xml: :text) }}</a>
                <h2>{{ post.title.encode(xml: :text) }}</h2>
                <ul>
                  % post.tags.split(", ").each do |tag|
                    <li class="tag">{{ tag }}</li>
                  % end
                </ul>
              </header>

              <section class="location">
                <ul>
                  <li class="float_left">{{ post.location }}</li>
                  <li>
                    % if post.remote == "true"
                      <i class="fa fa-globe"></i> Remote work OK
                    % else
                      <i class="fa fa-map-marker"></i> On-site only
                    % end
                  </li>
                </ul>
              </section>

              <p>{{ post.description.encode(xml: :text) }}</p>

              {{ this.partial("apply", post: post, developer: developer) }}

              {{ this.partial("favorite", post: post, developer: developer) }}<br>

              {{ this.partial("developer/add_message", post: post, developer: developer) }}

              <footer>
                <ul>
                  <li>
                    <time class="float_left" datetime="" pubdate>Posted on {{ post.posted }}
                    </time>
                  </li>
                  <li>
                    <time datetime="">
                      % if post.expires > 24
                        {{ (post.expires / 24).ceil }} days left to apply
                      % elsif post.expires <= 24 && post.expires > 1
                        {{ post.expires.ceil }} hours left to apply
                      % elsif post.expires <= 1
                        Less than 1 hour left to apply!
                      % end
                    </time>
                  </li>
                </ul>
              </footer>
            </article>
          </li>
          <hr/>
        % end
      % end
    </ul>
  % end
</span>
